function doLiveSearch(a,b){if(38==a.keyCode||40==a.keyCode)return!1;$("#livesearch_search_results").remove();updown=-1;if(""==b||2>b.length)return!1;b=encodeURI(b);$.ajax({url:$("base").attr("href")+"index.php?route=product/search/ajax&keyword="+b,dataType:"json",success:function(a){if(0<a.length){var f=document.createElement("ul");f.id="livesearch_search_results";var d,e,c;for(c in a)d=document.createElement("li"),"undefined"!=typeof a[c].li_class&&d.setAttribute("class",a[c].li_class),e=document.createElement("a"),
e.appendChild(document.createTextNode(a[c].name)),e.href="undefined"!=typeof a[c].href?a[c].href.replace(/&amp;/g,"&"):$("base").attr("href")+"index.php?route=product/product&product_id="+a[c].product_id+"&keyword="+b,d.appendChild(e),f.appendChild(d);0<$("#livesearch_search_results").length&&$("#livesearch_search_results").remove();$("#search").append(f)}}});return!0}
function upDownEvent(a){var b=document.getElementById("livesearch_search_results");$("#search").find("[name=search]").first();if(b){var g=b.childNodes.length-1;-1!=updown&&"undefined"!=typeof b.childNodes[updown]&&$(b.childNodes[updown]).removeClass("highlighted");38==a.keyCode?updown=0<updown?--updown:updown:40==a.keyCode&&(updown=updown<g?++updown:updown);0<=updown&&updown<=g&&($(b.childNodes[updown]).addClass("highlighted"),a=b.childNodes[updown].childNodes[0].text,"undefined"==typeof a&&(a=b.childNodes[updown].childNodes[0].innerText),
$("#search").find("[name=search]").first().val((new String(a)).replace(/(\s\(.*?\))$/,"")))}return!1}var updown=-1;
$(document).ready(function(){$("#search").find("[name=search]").first().keyup(function(a){doLiveSearch(a,this.value)}).focus(function(a){doLiveSearch(a,this.value)}).keydown(function(a){upDownEvent(a)}).blur(function(){window.setTimeout("$('#livesearch_search_results').remove();updown=0;",1500)});$(document).bind("keydown",function(a){try{13==a.keyCode&&0<$(".highlighted").length&&(document.location.href=$(".highlighted").find("a").first().attr("href"))}catch(b){}})});